<?xml version="1.0" encoding="UTF-8"?><ootb-template>
    <template-metadata name="AAA-ISE">
        <template-details>
            <description/>
            <author>root</author>
            <tag-list/><tag-list/>
        </template-details>
        <parameter-metadata>
            <param-group cliName="cli command set" isMandatory="true" name="AAA-ISE parameters">
                <description>Parameters for AAA-ISE</description>
                <parameter name="IntfName">
                    <description>IntfName</description>
                    <default-value label="IntfName">IntfName</default-value>
                    <data-type>DB</data-type>
                    <mandatory>true</mandatory>
                    <isGlobal>false</isGlobal>
                    <syntax>
                        <min>null</min>
                        <max>null</max>
                        <pattern/>
                    </syntax>
                    <isGlobalVariable>false</isGlobalVariable>
                </parameter>
                <parameter name="UpIntfName">
                    <description>UpIntfName</description>
                    <default-value label="UpIntfName">UpIntfName</default-value>
                    <data-type>DB</data-type>
                    <mandatory>true</mandatory>
                    <isGlobal>false</isGlobal>
                    <syntax>
                        <min>null</min>
                        <max>null</max>
                        <pattern/>
                    </syntax>
                    <isGlobalVariable>false</isGlobalVariable>
                </parameter>
                <parameter name="DownIntfName">
                    <description>DownIntfName</description>
                    <default-value label="DownIntfName">DownIntfName</default-value>
                    <data-type>DB</data-type>
                    <mandatory>true</mandatory>
                    <isGlobal>false</isGlobal>
                    <syntax>
                        <min>null</min>
                        <max>null</max>
                        <pattern/>
                    </syntax>
                    <isGlobalVariable>false</isGlobalVariable>
                </parameter>
                <parameter name="AllIntf">
                    <description>AllIntf</description>
                    <default-value label="AllIntf">AllIntf</default-value>
                    <data-type>DB</data-type>
                    <mandatory>true</mandatory>
                    <isGlobal>false</isGlobal>
                    <syntax>
                        <min>null</min>
                        <max>null</max>
                        <pattern/>
                    </syntax>
                    <isGlobalVariable>false</isGlobalVariable>
                </parameter>
                <parameter name="EveryIntf">
                    <description>EveryIntf</description>
                    <default-value label="EveryIntf">EveryIntf</default-value>
                    <data-type>DB</data-type>
                    <mandatory>true</mandatory>
                    <isGlobal>false</isGlobal>
                    <syntax>
                        <min>null</min>
                        <max>null</max>
                        <pattern/>
                    </syntax>
                    <isGlobalVariable>false</isGlobalVariable>
                </parameter>
                <parameter name="DeviceName">
                    <description>DeviceName</description>
                    <default-value label="DeviceName">DeviceName</default-value>
                    <data-type>DB</data-type>
                    <mandatory>true</mandatory>
                    <isGlobal>false</isGlobal>
                    <syntax>
                        <min>null</min>
                        <max>null</max>
                        <pattern/>
                    </syntax>
                    <isGlobalVariable>false</isGlobalVariable>
                </parameter>
                <parameter name="ProductSeries">
                    <description>ProductSeries</description>
                    <default-value label="ProductSeries">ProductSeries</default-value>
                    <data-type>DB</data-type>
                    <mandatory>true</mandatory>
                    <isGlobal>false</isGlobal>
                    <syntax>
                        <min>null</min>
                        <max>null</max>
                        <pattern/>
                    </syntax>
                    <isGlobalVariable>false</isGlobalVariable>
                </parameter>
                <parameter name="SysObjectID">
                    <description>SysObjectID</description>
                    <default-value label="SysObjectID">SysObjectID</default-value>
                    <data-type>DB</data-type>
                    <mandatory>true</mandatory>
                    <isGlobal>false</isGlobal>
                    <syntax>
                        <min>null</min>
                        <max>null</max>
                        <pattern/>
                    </syntax>
                    <isGlobalVariable>false</isGlobalVariable>
                </parameter>
                <parameter name="IPAddress">
                    <description>IPAddress</description>
                    <default-value label="IPAddress">IPAddress</default-value>
                    <data-type>DB</data-type>
                    <mandatory>true</mandatory>
                    <isGlobal>false</isGlobal>
                    <syntax>
                        <min>null</min>
                        <max>null</max>
                        <pattern/>
                    </syntax>
                    <isGlobalVariable>false</isGlobalVariable>
                </parameter>
                <parameter name="SoftwareVersion">
                    <description>SoftwareVersion</description>
                    <default-value label="SoftwareVersion">SoftwareVersion</default-value>
                    <data-type>DB</data-type>
                    <mandatory>true</mandatory>
                    <isGlobal>false</isGlobal>
                    <syntax>
                        <min>null</min>
                        <max>null</max>
                        <pattern/>
                    </syntax>
                    <isGlobalVariable>false</isGlobalVariable>
                </parameter>
                <parameter name="SerialNumber">
                    <description>SerialNumber</description>
                    <default-value label="SerialNumber">SerialNumber</default-value>
                    <data-type>DB</data-type>
                    <mandatory>true</mandatory>
                    <isGlobal>false</isGlobal>
                    <syntax>
                        <min>null</min>
                        <max>null</max>
                        <pattern/>
                    </syntax>
                    <isGlobalVariable>false</isGlobalVariable>
                </parameter>
                <parameter name="ModelNumber">
                    <description>ModelNumber</description>
                    <default-value label="ModelNumber">ModelNumber</default-value>
                    <data-type>DB</data-type>
                    <mandatory>true</mandatory>
                    <isGlobal>false</isGlobal>
                    <syntax>
                        <min>null</min>
                        <max>null</max>
                        <pattern/>
                    </syntax>
                    <isGlobalVariable>false</isGlobalVariable>
                </parameter>
                <parameter name="ImageName">
                    <description>ImageName</description>
                    <default-value label="ImageName">ImageName</default-value>
                    <data-type>DB</data-type>
                    <mandatory>true</mandatory>
                    <isGlobal>false</isGlobal>
                    <syntax>
                        <min>null</min>
                        <max>null</max>
                        <pattern/>
                    </syntax>
                    <isGlobalVariable>false</isGlobalVariable>
                </parameter>
                <parameter name="ImageVersion">
                    <description>ImageVersion</description>
                    <default-value label="ImageVersion">ImageVersion</default-value>
                    <data-type>DB</data-type>
                    <mandatory>true</mandatory>
                    <isGlobal>false</isGlobal>
                    <syntax>
                        <min>null</min>
                        <max>null</max>
                        <pattern/>
                    </syntax>
                    <isGlobalVariable>false</isGlobalVariable>
                </parameter>
                <parameter name="VlanId">
                    <description>VlanId</description>
                    <default-value label="VlanId">VlanId</default-value>
                    <data-type>DB</data-type>
                    <mandatory>true</mandatory>
                    <isGlobal>false</isGlobal>
                    <syntax>
                        <min>null</min>
                        <max>null</max>
                        <pattern/>
                    </syntax>
                    <isGlobalVariable>false</isGlobalVariable>
                </parameter>
                <parameter name="VlanName">
                    <description>VlanName</description>
                    <default-value label="VlanName">VlanName</default-value>
                    <data-type>DB</data-type>
                    <mandatory>true</mandatory>
                    <isGlobal>false</isGlobal>
                    <syntax>
                        <min>null</min>
                        <max>null</max>
                        <pattern/>
                    </syntax>
                    <isGlobalVariable>false</isGlobalVariable>
                </parameter>
                <parameter name="ProductType">
                    <description>ProductType</description>
                    <default-value label="ProductType">ProductType</default-value>
                    <data-type>DB</data-type>
                    <mandatory>true</mandatory>
                    <isGlobal>false</isGlobal>
                    <syntax>
                        <min>null</min>
                        <max>null</max>
                        <pattern/>
                    </syntax>
                    <isGlobalVariable>false</isGlobalVariable>
                </parameter>
                <parameter name="ImageFileName">
                    <description>ImageFileName</description>
                    <default-value label="ImageFileName">ImageFileName</default-value>
                    <data-type>DB</data-type>
                    <mandatory>true</mandatory>
                    <isGlobal>false</isGlobal>
                    <syntax>
                        <min>null</min>
                        <max>null</max>
                        <pattern/>
                    </syntax>
                    <isGlobalVariable>false</isGlobalVariable>
                </parameter>
            </param-group>
        </parameter-metadata>
    </template-metadata>
    <config>
        <device-filtering-details>
            <family value="Routers,Switches and Hubs">
                <min-supported-imageversion value=""/>
            </family>
        </device-filtering-details>
        <cli name="cli command set">
            <clicommand>!
! IntfName = $IntfName
! UpIntfName = $UpIntfName
! DownIntfName = $DownIntfName
! AllIntf = $AllIntf
! EveryIntf = $EveryIntf
! DeviceName = $DeviceName
! ProductSeries = $ProductSeries
! SysObjectID = $SysObjectID
! IPAddress = $IPAddress
! SoftwareVersion = $SoftwareVersion
! SerialNumber = $SerialNumber
! ModelNumber = $ModelNumber
! ImageName = $ImageName
! ImageFileName = $ImageFileName
! ImageVersion = $ImageVersion
! VlanId = $VlanId
! VlanName = $VlanName
! ProductType = $ProductType
!

#if ($ModelNumber.matches(".*C3560CG.*") &amp;&amp; $SoftwareVersion.matches("^15.2.*"))
!
enable secret cisco
!
aaa new-model
!

#if ($DeviceName.matches("POD1.*"))
#set ( $IPISE1 = "10.201.31.108" )
#set ( $IPISE2 = "10.201.31.109" )

#elseif ($DeviceName.matches("POD2.*"))
#set ( $IPISE1 = "10.202.31.108" )
#set ( $IPISE2 = "10.202.31.109" )

#elseif ($DeviceName.matches("POD3.*"))
#set ( $IPISE1 = "10.203.31.108" )
#set ( $IPISE2 = "10.203.31.109" )

#elseif ($DeviceName.matches("POD4.*"))
#set ( $IPISE1 = "10.204.31.108" )
#set ( $IPISE2 = "10.204.31.109" )

#elseif ($DeviceName.matches("POD5.*"))
#set ( $IPISE1 = "10.205.31.108" )
#set ( $IPISE2 = "10.205.31.109" )

#elseif ($DeviceName.matches("POD6.*"))
#set ( $IPISE1 = "10.206.31.108" )
#set ( $IPISE2 = "10.206.31.109" )

#elseif ($DeviceName.matches("POD7.*"))
#set ( $IPISE1 = "10.207.31.108" )
#set ( $IPISE2 = "10.207.31.109" )

#elseif ($DeviceName.matches("POD8.*"))
#set ( $IPISE1 = "10.208.31.108" )
#set ( $IPISE2 = "10.208.31.109" )

#elseif ($DeviceName.matches("POD9.*"))
#set ( $IPISE1 = "10.209.31.108" )
#set ( $IPISE2 = "10.209.31.109" )

#end

enable secret cisco
!
aaa new-model
!
radius server NODE-ISE1
 address ipv4 $IPISE1 auth-port 1645 acct-port 1646
 key C1sco12345
 timeout 1
!
radius server NODE-ISE2
 address ipv4 $IPISE2 auth-port 1645 acct-port 1646
 key C1sco12345
 timeout 1
!
aaa group server radius ISE
 server name NODE-ISE1
 server name NODE-ISE2
!
aaa authentication dot1x default group ISE
aaa authorization network default group ISE 
!
#INTERACTIVE
aaa accounting identity default start-stop group ISE&lt;IQ&gt;yes&lt;R&gt;yes
#ENDS_INTERACTIVE
!
dot1x system-auth-control

class-map type control subscriber match-all DOT1X_NO_RESP
 match method dot1x
 match result-type method dot1x agent-not-found
!
!
class-map type control subscriber match-all MAB_FAILED
 match method mab
 match result-type method mab authoritative
!
!
policy-map type control subscriber ENT-IDENTITY-POL
 event session-started match-all
  10 class always do-until-failure
   10 authenticate using dot1x priority 10
   20 authenticate using mab priority 20
 event authentication-failure match-first
  10 class DOT1X_NO_RESP do-until-failure
   10 terminate dot1x
  20 class MAB_FAILED do-until-failure
   10 terminate mab
   20 authentication-restart 60
  30 class always do-until-failure
   10 terminate dot1x
   20 terminate mab
   30 authentication-restart 60
 event agent-found match-all
  10 class always do-until-failure
   10 terminate mab
   20 authenticate using dot1x priority 10
!
!
username IseIseBaby privilege 15 secret C1sco12345
!
snmp-server view ISE_READ iso included
snmp-server view ISE_WRITE iso included
!
snmp-server group ISE v3 priv read ISE_READ write ISE_WRITE
!
snmp-server user IseIseBaby ISE v3 auth sha C1sco12345 priv aes 256 C1sco12345
!
snmp-server host $IPISE1 version 3 priv IseIseBaby  
snmp-server host $IPISE2 version 3 priv IseIseBaby  
!
template USERS_INTERFACE_TEMPLATE
 no switchport port-security aging time 1
 no switchport port-security aging type inactivity
 no switchport port-security
 service-policy type control subscriber ENT-IDENTITY-POL
 access-session port-control auto
 mab
 dot1x pae authenticator
!
#end






















</clicommand>
        </cli>
    </config>
</ootb-template>